Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_336', model='PatchTST', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Epoch: 1 cost time: 37.748438596725464
Epoch: 1, Steps: 62 | Train Loss: 0.8136388 Vali Loss: 0.5028579 Test Loss: 0.3921152
Validation loss decreased (inf --> 0.502858).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 36.07412075996399
Epoch: 2, Steps: 62 | Train Loss: 0.7466025 Vali Loss: 0.4146538 Test Loss: 0.3574964
Validation loss decreased (0.502858 --> 0.414654).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 39.86015510559082
Epoch: 3, Steps: 62 | Train Loss: 0.6835902 Vali Loss: 0.3932451 Test Loss: 0.3449665
Validation loss decreased (0.414654 --> 0.393245).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 32.76386117935181
Epoch: 4, Steps: 62 | Train Loss: 0.6566790 Vali Loss: 0.3825042 Test Loss: 0.3373717
Validation loss decreased (0.393245 --> 0.382504).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 33.093929290771484
Epoch: 5, Steps: 62 | Train Loss: 0.6428294 Vali Loss: 0.3764282 Test Loss: 0.3347893
Validation loss decreased (0.382504 --> 0.376428).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 43.55784511566162
Epoch: 6, Steps: 62 | Train Loss: 0.6320867 Vali Loss: 0.3701328 Test Loss: 0.3328960
Validation loss decreased (0.376428 --> 0.370133).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 34.869298458099365
Epoch: 7, Steps: 62 | Train Loss: 0.6268984 Vali Loss: 0.3695926 Test Loss: 0.3314199
Validation loss decreased (0.370133 --> 0.369593).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 35.6677827835083
Epoch: 8, Steps: 62 | Train Loss: 0.6229211 Vali Loss: 0.3667947 Test Loss: 0.3290751
Validation loss decreased (0.369593 --> 0.366795).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 39.94729804992676
Epoch: 9, Steps: 62 | Train Loss: 0.6185632 Vali Loss: 0.3680780 Test Loss: 0.3289822
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 34.777766942977905
Epoch: 10, Steps: 62 | Train Loss: 0.6142842 Vali Loss: 0.3663821 Test Loss: 0.3280829
Validation loss decreased (0.366795 --> 0.366382).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 36.420143842697144
Epoch: 11, Steps: 62 | Train Loss: 0.6119046 Vali Loss: 0.3673088 Test Loss: 0.3275156
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 36.01282215118408
Epoch: 12, Steps: 62 | Train Loss: 0.6079944 Vali Loss: 0.3676158 Test Loss: 0.3265592
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 35.613683223724365
Epoch: 13, Steps: 62 | Train Loss: 0.6058517 Vali Loss: 0.3654899 Test Loss: 0.3266827
Validation loss decreased (0.366382 --> 0.365490).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 33.57193684577942
Epoch: 14, Steps: 62 | Train Loss: 0.6028440 Vali Loss: 0.3662611 Test Loss: 0.3262147
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 36.767799854278564
Epoch: 15, Steps: 62 | Train Loss: 0.6004694 Vali Loss: 0.3687449 Test Loss: 0.3265569
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 44.972795486450195
Epoch: 16, Steps: 62 | Train Loss: 0.5985287 Vali Loss: 0.3683307 Test Loss: 0.3271796
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 43.77728343009949
Epoch: 17, Steps: 62 | Train Loss: 0.5995332 Vali Loss: 0.3704421 Test Loss: 0.3268069
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 41.89568829536438
Epoch: 18, Steps: 62 | Train Loss: 0.5956244 Vali Loss: 0.3680327 Test Loss: 0.3275411
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 43.291595697402954
Epoch: 19, Steps: 62 | Train Loss: 0.5956534 Vali Loss: 0.3681288 Test Loss: 0.3276648
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 43.92372941970825
Epoch: 20, Steps: 62 | Train Loss: 0.5942202 Vali Loss: 0.3664542 Test Loss: 0.3278325
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 41.49484634399414
Epoch: 21, Steps: 62 | Train Loss: 0.5924829 Vali Loss: 0.3680240 Test Loss: 0.3284212
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 40.133623123168945
Epoch: 22, Steps: 62 | Train Loss: 0.5926206 Vali Loss: 0.3647806 Test Loss: 0.3283413
Validation loss decreased (0.365490 --> 0.364781).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 41.90422034263611
Epoch: 23, Steps: 62 | Train Loss: 0.5930531 Vali Loss: 0.3641249 Test Loss: 0.3288497
Validation loss decreased (0.364781 --> 0.364125).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 41.34043788909912
Epoch: 24, Steps: 62 | Train Loss: 0.5919498 Vali Loss: 0.3663185 Test Loss: 0.3291938
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 45.28862428665161
Epoch: 25, Steps: 62 | Train Loss: 0.5901876 Vali Loss: 0.3664979 Test Loss: 0.3291620
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 42.74947261810303
Epoch: 26, Steps: 62 | Train Loss: 0.5915637 Vali Loss: 0.3653907 Test Loss: 0.3295070
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 43.008955240249634
Epoch: 27, Steps: 62 | Train Loss: 0.5908157 Vali Loss: 0.3657784 Test Loss: 0.3295222
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 34.3159818649292
Epoch: 28, Steps: 62 | Train Loss: 0.5916501 Vali Loss: 0.3662026 Test Loss: 0.3295669
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 32.53280472755432
Epoch: 29, Steps: 62 | Train Loss: 0.5903342 Vali Loss: 0.3659693 Test Loss: 0.3297233
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 35.64562010765076
Epoch: 30, Steps: 62 | Train Loss: 0.5899075 Vali Loss: 0.3651283 Test Loss: 0.3298448
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 33.813512563705444
Epoch: 31, Steps: 62 | Train Loss: 0.5896518 Vali Loss: 0.3640810 Test Loss: 0.3299642
Validation loss decreased (0.364125 --> 0.364081).  Saving model ...
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 21.320626974105835
Epoch: 32, Steps: 62 | Train Loss: 0.5893194 Vali Loss: 0.3643472 Test Loss: 0.3299470
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 22.25636911392212
Epoch: 33, Steps: 62 | Train Loss: 0.5892512 Vali Loss: 0.3651913 Test Loss: 0.3300015
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 20.703614473342896
Epoch: 34, Steps: 62 | Train Loss: 0.5886144 Vali Loss: 0.3630358 Test Loss: 0.3298902
Validation loss decreased (0.364081 --> 0.363036).  Saving model ...
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 20.28294086456299
Epoch: 35, Steps: 62 | Train Loss: 0.5893720 Vali Loss: 0.3662089 Test Loss: 0.3301560
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 20.279290199279785
Epoch: 36, Steps: 62 | Train Loss: 0.5872121 Vali Loss: 0.3654410 Test Loss: 0.3302786
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 20.308217525482178
Epoch: 37, Steps: 62 | Train Loss: 0.5892953 Vali Loss: 0.3652221 Test Loss: 0.3302003
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 26.376270055770874
Epoch: 38, Steps: 62 | Train Loss: 0.5890619 Vali Loss: 0.3656019 Test Loss: 0.3302324
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 26.237029552459717
Epoch: 39, Steps: 62 | Train Loss: 0.5882973 Vali Loss: 0.3668066 Test Loss: 0.3299758
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 28.601645469665527
Epoch: 40, Steps: 62 | Train Loss: 0.5883987 Vali Loss: 0.3665451 Test Loss: 0.3304360
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 25.97455406188965
Epoch: 41, Steps: 62 | Train Loss: 0.5876533 Vali Loss: 0.3671276 Test Loss: 0.3305070
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 28.645038843154907
Epoch: 42, Steps: 62 | Train Loss: 0.5874327 Vali Loss: 0.3667732 Test Loss: 0.3303585
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 29.338101148605347
Epoch: 43, Steps: 62 | Train Loss: 0.5880225 Vali Loss: 0.3652133 Test Loss: 0.3303612
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 29.079097747802734
Epoch: 44, Steps: 62 | Train Loss: 0.5882260 Vali Loss: 0.3655856 Test Loss: 0.3303697
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 29.128586530685425
Epoch: 45, Steps: 62 | Train Loss: 0.5890235 Vali Loss: 0.3659761 Test Loss: 0.3305798
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 27.27730393409729
Epoch: 46, Steps: 62 | Train Loss: 0.5885456 Vali Loss: 0.3633616 Test Loss: 0.3305253
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 27.548799753189087
Epoch: 47, Steps: 62 | Train Loss: 0.5874880 Vali Loss: 0.3627190 Test Loss: 0.3305849
Validation loss decreased (0.363036 --> 0.362719).  Saving model ...
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 29.45721125602722
Epoch: 48, Steps: 62 | Train Loss: 0.5884486 Vali Loss: 0.3649759 Test Loss: 0.3304654
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 28.367849349975586
Epoch: 49, Steps: 62 | Train Loss: 0.5890375 Vali Loss: 0.3675025 Test Loss: 0.3303657
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 26.382288932800293
Epoch: 50, Steps: 62 | Train Loss: 0.5885708 Vali Loss: 0.3637193 Test Loss: 0.3304850
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 29.601882219314575
Epoch: 51, Steps: 62 | Train Loss: 0.5874029 Vali Loss: 0.3657909 Test Loss: 0.3305452
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 31.923198461532593
Epoch: 52, Steps: 62 | Train Loss: 0.5880683 Vali Loss: 0.3648111 Test Loss: 0.3305365
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 28.41704249382019
Epoch: 53, Steps: 62 | Train Loss: 0.5877702 Vali Loss: 0.3641588 Test Loss: 0.3307097
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 32.74245047569275
Epoch: 54, Steps: 62 | Train Loss: 0.5867726 Vali Loss: 0.3651601 Test Loss: 0.3304622
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 36.14385366439819
Epoch: 55, Steps: 62 | Train Loss: 0.5875945 Vali Loss: 0.3665968 Test Loss: 0.3306296
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 31.201775074005127
Epoch: 56, Steps: 62 | Train Loss: 0.5868003 Vali Loss: 0.3652367 Test Loss: 0.3306503
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 35.11635112762451
Epoch: 57, Steps: 62 | Train Loss: 0.5874718 Vali Loss: 0.3617876 Test Loss: 0.3305275
Validation loss decreased (0.362719 --> 0.361788).  Saving model ...
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 33.513490438461304
Epoch: 58, Steps: 62 | Train Loss: 0.5868885 Vali Loss: 0.3633206 Test Loss: 0.3307699
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 38.64289975166321
Epoch: 59, Steps: 62 | Train Loss: 0.5874627 Vali Loss: 0.3655585 Test Loss: 0.3306316
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 33.4257869720459
Epoch: 60, Steps: 62 | Train Loss: 0.5871078 Vali Loss: 0.3631192 Test Loss: 0.3305757
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 31.477477073669434
Epoch: 61, Steps: 62 | Train Loss: 0.5888485 Vali Loss: 0.3661056 Test Loss: 0.3305551
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 32.512330293655396
Epoch: 62, Steps: 62 | Train Loss: 0.5874293 Vali Loss: 0.3655423 Test Loss: 0.3308405
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 31.272764921188354
Epoch: 63, Steps: 62 | Train Loss: 0.5869035 Vali Loss: 0.3630253 Test Loss: 0.3306247
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 40.64289927482605
Epoch: 64, Steps: 62 | Train Loss: 0.5872754 Vali Loss: 0.3638539 Test Loss: 0.3303285
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 38.999682903289795
Epoch: 65, Steps: 62 | Train Loss: 0.5891845 Vali Loss: 0.3649924 Test Loss: 0.3307293
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 40.618167877197266
Epoch: 66, Steps: 62 | Train Loss: 0.5873428 Vali Loss: 0.3656209 Test Loss: 0.3304783
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 41.119497776031494
Epoch: 67, Steps: 62 | Train Loss: 0.5877117 Vali Loss: 0.3654227 Test Loss: 0.3307754
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 41.676432371139526
Epoch: 68, Steps: 62 | Train Loss: 0.5886265 Vali Loss: 0.3648770 Test Loss: 0.3306550
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 39.851893186569214
Epoch: 69, Steps: 62 | Train Loss: 0.5879036 Vali Loss: 0.3673054 Test Loss: 0.3306189
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 28.330678462982178
Epoch: 70, Steps: 62 | Train Loss: 0.5883109 Vali Loss: 0.3654451 Test Loss: 0.3305720
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 29.53958296775818
Epoch: 71, Steps: 62 | Train Loss: 0.5883395 Vali Loss: 0.3642885 Test Loss: 0.3307294
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 27.897854328155518
Epoch: 72, Steps: 62 | Train Loss: 0.5881238 Vali Loss: 0.3650774 Test Loss: 0.3305658
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 33.425241470336914
Epoch: 73, Steps: 62 | Train Loss: 0.5890792 Vali Loss: 0.3661684 Test Loss: 0.3305911
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 31.712562799453735
Epoch: 74, Steps: 62 | Train Loss: 0.5884790 Vali Loss: 0.3636947 Test Loss: 0.3306863
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 32.54130959510803
Epoch: 75, Steps: 62 | Train Loss: 0.5867290 Vali Loss: 0.3651775 Test Loss: 0.3305355
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 33.41815757751465
Epoch: 76, Steps: 62 | Train Loss: 0.5884295 Vali Loss: 0.3642898 Test Loss: 0.3308460
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 34.66015315055847
Epoch: 77, Steps: 62 | Train Loss: 0.5866533 Vali Loss: 0.3640553 Test Loss: 0.3303432
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 31.858005046844482
Epoch: 78, Steps: 62 | Train Loss: 0.5873364 Vali Loss: 0.3659884 Test Loss: 0.3306872
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 30.18833351135254
Epoch: 79, Steps: 62 | Train Loss: 0.5877495 Vali Loss: 0.3644853 Test Loss: 0.3305716
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 29.25529456138611
Epoch: 80, Steps: 62 | Train Loss: 0.5882376 Vali Loss: 0.3640848 Test Loss: 0.3305893
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 31.09657859802246
Epoch: 81, Steps: 62 | Train Loss: 0.5877633 Vali Loss: 0.3652694 Test Loss: 0.3306916
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 30.93409037590027
Epoch: 82, Steps: 62 | Train Loss: 0.5880307 Vali Loss: 0.3651519 Test Loss: 0.3306925
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 30.740592002868652
Epoch: 83, Steps: 62 | Train Loss: 0.5868238 Vali Loss: 0.3657174 Test Loss: 0.3305829
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 28.82795238494873
Epoch: 84, Steps: 62 | Train Loss: 0.5883600 Vali Loss: 0.3643579 Test Loss: 0.3305887
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 31.79573154449463
Epoch: 85, Steps: 62 | Train Loss: 0.5870378 Vali Loss: 0.3647384 Test Loss: 0.3306183
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 36.755987882614136
Epoch: 86, Steps: 62 | Train Loss: 0.5894049 Vali Loss: 0.3640077 Test Loss: 0.3307074
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 29.91294765472412
Epoch: 87, Steps: 62 | Train Loss: 0.5887273 Vali Loss: 0.3653006 Test Loss: 0.3307836
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 31.223484754562378
Epoch: 88, Steps: 62 | Train Loss: 0.5881898 Vali Loss: 0.3659344 Test Loss: 0.3307534
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 28.81946063041687
Epoch: 89, Steps: 62 | Train Loss: 0.5885021 Vali Loss: 0.3614665 Test Loss: 0.3308229
Validation loss decreased (0.361788 --> 0.361467).  Saving model ...
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 31.594393730163574
Epoch: 90, Steps: 62 | Train Loss: 0.5871978 Vali Loss: 0.3633149 Test Loss: 0.3307434
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 31.127272844314575
Epoch: 91, Steps: 62 | Train Loss: 0.5879668 Vali Loss: 0.3662050 Test Loss: 0.3305314
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 30.2127583026886
Epoch: 92, Steps: 62 | Train Loss: 0.5896933 Vali Loss: 0.3644070 Test Loss: 0.3307215
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 27.15659260749817
Epoch: 93, Steps: 62 | Train Loss: 0.5892144 Vali Loss: 0.3639019 Test Loss: 0.3306620
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 27.025166749954224
Epoch: 94, Steps: 62 | Train Loss: 0.5861721 Vali Loss: 0.3654485 Test Loss: 0.3306504
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 30.360280513763428
Epoch: 95, Steps: 62 | Train Loss: 0.5862043 Vali Loss: 0.3652902 Test Loss: 0.3304793
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 29.961388111114502
Epoch: 96, Steps: 62 | Train Loss: 0.5871625 Vali Loss: 0.3657579 Test Loss: 0.3306037
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 25.429020643234253
Epoch: 97, Steps: 62 | Train Loss: 0.5880090 Vali Loss: 0.3664146 Test Loss: 0.3305923
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 26.956684112548828
Epoch: 98, Steps: 62 | Train Loss: 0.5878482 Vali Loss: 0.3626519 Test Loss: 0.3306642
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 38.044800758361816
Epoch: 99, Steps: 62 | Train Loss: 0.5890939 Vali Loss: 0.3668580 Test Loss: 0.3306339
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 37.404178619384766
Epoch: 100, Steps: 62 | Train Loss: 0.5881664 Vali Loss: 0.3659920 Test Loss: 0.3307030
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.3308228850364685, mae:0.38042521476745605, rse:0.45949962735176086
