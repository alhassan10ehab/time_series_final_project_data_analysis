Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_192', model='PatchTST', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4980478
	speed: 0.3396s/iter; left time: 8966.5741s
	iters: 200, epoch: 1 | loss: 0.4358420
	speed: 0.2928s/iter; left time: 7701.0625s
Epoch: 1 cost time: 90.07105040550232
Epoch: 1, Steps: 265 | Train Loss: 0.4659868 Vali Loss: 0.5813559 Test Loss: 0.4027433
Validation loss decreased (inf --> 0.581356).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3741230
	speed: 3.7820s/iter; left time: 98846.5175s
	iters: 200, epoch: 2 | loss: 0.3615122
	speed: 0.7120s/iter; left time: 18537.5040s
Epoch: 2 cost time: 185.10612297058105
Epoch: 2, Steps: 265 | Train Loss: 0.3727991 Vali Loss: 0.5329338 Test Loss: 0.3677257
Validation loss decreased (0.581356 --> 0.532934).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.3390256
	speed: 4.1110s/iter; left time: 106355.8072s
	iters: 200, epoch: 3 | loss: 0.3371929
	speed: 0.5563s/iter; left time: 14337.0441s
Epoch: 3 cost time: 165.14310503005981
Epoch: 3, Steps: 265 | Train Loss: 0.3469846 Vali Loss: 0.5201007 Test Loss: 0.3544027
Validation loss decreased (0.532934 --> 0.520101).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3092409
	speed: 1.5597s/iter; left time: 39936.9048s
	iters: 200, epoch: 4 | loss: 0.3205175
	speed: 0.2390s/iter; left time: 6095.8352s
Epoch: 4 cost time: 62.35009241104126
Epoch: 4, Steps: 265 | Train Loss: 0.3338582 Vali Loss: 0.5123190 Test Loss: 0.3479733
Validation loss decreased (0.520101 --> 0.512319).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3384056
	speed: 0.9180s/iter; left time: 23263.1342s
	iters: 200, epoch: 5 | loss: 0.2977749
	speed: 0.2250s/iter; left time: 5679.1435s
Epoch: 5 cost time: 63.26203751564026
Epoch: 5, Steps: 265 | Train Loss: 0.3262006 Vali Loss: 0.5093103 Test Loss: 0.3449559
Validation loss decreased (0.512319 --> 0.509310).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3177585
	speed: 0.9630s/iter; left time: 24148.3374s
	iters: 200, epoch: 6 | loss: 0.3071154
	speed: 0.2430s/iter; left time: 6069.0111s
Epoch: 6 cost time: 66.02996730804443
Epoch: 6, Steps: 265 | Train Loss: 0.3215570 Vali Loss: 0.5046445 Test Loss: 0.3422752
Validation loss decreased (0.509310 --> 0.504644).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.3081749
	speed: 0.9750s/iter; left time: 24190.7346s
	iters: 200, epoch: 7 | loss: 0.2996874
	speed: 0.2391s/iter; left time: 5909.1058s
Epoch: 7 cost time: 64.36372518539429
Epoch: 7, Steps: 265 | Train Loss: 0.3177158 Vali Loss: 0.5038484 Test Loss: 0.3408032
Validation loss decreased (0.504644 --> 0.503848).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.3292859
	speed: 0.9709s/iter; left time: 23831.0346s
	iters: 200, epoch: 8 | loss: 0.2935843
	speed: 0.2250s/iter; left time: 5500.3893s
Epoch: 8 cost time: 62.75219702720642
Epoch: 8, Steps: 265 | Train Loss: 0.3138181 Vali Loss: 0.5039441 Test Loss: 0.3364579
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.3433025
	speed: 0.9420s/iter; left time: 22872.5993s
	iters: 200, epoch: 9 | loss: 0.3202278
	speed: 0.2300s/iter; left time: 5561.6358s
Epoch: 9 cost time: 63.80513286590576
Epoch: 9, Steps: 265 | Train Loss: 0.3092005 Vali Loss: 0.5008693 Test Loss: 0.3365051
Validation loss decreased (0.503848 --> 0.500869).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.3063143
	speed: 0.9540s/iter; left time: 22911.1900s
	iters: 200, epoch: 10 | loss: 0.2939346
	speed: 0.2340s/iter; left time: 5596.3547s
Epoch: 10 cost time: 63.08816599845886
Epoch: 10, Steps: 265 | Train Loss: 0.3053536 Vali Loss: 0.4989036 Test Loss: 0.3342584
Validation loss decreased (0.500869 --> 0.498904).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.3093591
	speed: 0.9130s/iter; left time: 21684.6793s
	iters: 200, epoch: 11 | loss: 0.2703374
	speed: 0.2500s/iter; left time: 5912.6992s
Epoch: 11 cost time: 65.23132538795471
Epoch: 11, Steps: 265 | Train Loss: 0.3019392 Vali Loss: 0.4975918 Test Loss: 0.3338916
Validation loss decreased (0.498904 --> 0.497592).  Saving model ...
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3010681
	speed: 0.9570s/iter; left time: 22476.1675s
	iters: 200, epoch: 12 | loss: 0.2825552
	speed: 0.2340s/iter; left time: 5472.2809s
Epoch: 12 cost time: 66.85384106636047
Epoch: 12, Steps: 265 | Train Loss: 0.2983993 Vali Loss: 0.4940282 Test Loss: 0.3331291
Validation loss decreased (0.497592 --> 0.494028).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2989858
	speed: 0.9820s/iter; left time: 22803.0520s
	iters: 200, epoch: 13 | loss: 0.2985443
	speed: 0.2440s/iter; left time: 5641.4794s
Epoch: 13 cost time: 64.28492832183838
Epoch: 13, Steps: 265 | Train Loss: 0.2953095 Vali Loss: 0.4967352 Test Loss: 0.3307018
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.3233181
	speed: 2.1401s/iter; left time: 49128.2417s
	iters: 200, epoch: 14 | loss: 0.2779854
	speed: 0.4899s/iter; left time: 11197.0736s
Epoch: 14 cost time: 131.11233043670654
Epoch: 14, Steps: 265 | Train Loss: 0.2926147 Vali Loss: 0.4971270 Test Loss: 0.3299749
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2820654
	speed: 2.3070s/iter; left time: 52348.1964s
	iters: 200, epoch: 15 | loss: 0.2902302
	speed: 0.4920s/iter; left time: 11114.6941s
Epoch: 15 cost time: 133.00045490264893
Epoch: 15, Steps: 265 | Train Loss: 0.2900312 Vali Loss: 0.4995140 Test Loss: 0.3315741
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2892813
	speed: 1.1690s/iter; left time: 26216.0839s
	iters: 200, epoch: 16 | loss: 0.3011401
	speed: 0.2490s/iter; left time: 5559.0536s
Epoch: 16 cost time: 65.19146299362183
Epoch: 16, Steps: 265 | Train Loss: 0.2879452 Vali Loss: 0.4930026 Test Loss: 0.3324728
Validation loss decreased (0.494028 --> 0.493003).  Saving model ...
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2543726
	speed: 0.9520s/iter; left time: 21097.2586s
	iters: 200, epoch: 17 | loss: 0.2959467
	speed: 0.2360s/iter; left time: 5206.3332s
Epoch: 17 cost time: 63.07371926307678
Epoch: 17, Steps: 265 | Train Loss: 0.2858299 Vali Loss: 0.4913820 Test Loss: 0.3300434
Validation loss decreased (0.493003 --> 0.491382).  Saving model ...
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2563797
	speed: 0.9310s/iter; left time: 20385.1615s
	iters: 200, epoch: 18 | loss: 0.2655557
	speed: 0.2440s/iter; left time: 5318.3301s
Epoch: 18 cost time: 63.0131459236145
Epoch: 18, Steps: 265 | Train Loss: 0.2842018 Vali Loss: 0.4922622 Test Loss: 0.3308011
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2798676
	speed: 0.9180s/iter; left time: 19857.1344s
	iters: 200, epoch: 19 | loss: 0.2705840
	speed: 0.2530s/iter; left time: 5447.3652s
Epoch: 19 cost time: 64.63856315612793
Epoch: 19, Steps: 265 | Train Loss: 0.2819761 Vali Loss: 0.4930702 Test Loss: 0.3319732
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2559218
	speed: 0.9580s/iter; left time: 20468.6251s
	iters: 200, epoch: 20 | loss: 0.2731487
	speed: 0.2530s/iter; left time: 5380.2669s
Epoch: 20 cost time: 67.39853382110596
Epoch: 20, Steps: 265 | Train Loss: 0.2801077 Vali Loss: 0.4918819 Test Loss: 0.3305235
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2918155
	speed: 0.9580s/iter; left time: 20214.8738s
	iters: 200, epoch: 21 | loss: 0.2607533
	speed: 0.2500s/iter; left time: 5250.2253s
Epoch: 21 cost time: 64.95422005653381
Epoch: 21, Steps: 265 | Train Loss: 0.2777128 Vali Loss: 0.4875978 Test Loss: 0.3318628
Validation loss decreased (0.491382 --> 0.487598).  Saving model ...
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2748173
	speed: 0.9610s/iter; left time: 20023.2616s
	iters: 200, epoch: 22 | loss: 0.3041491
	speed: 0.2270s/iter; left time: 4707.0980s
Epoch: 22 cost time: 61.49326229095459
Epoch: 22, Steps: 265 | Train Loss: 0.2760754 Vali Loss: 0.4900044 Test Loss: 0.3339660
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2668869
	speed: 0.9450s/iter; left time: 19439.5950s
	iters: 200, epoch: 23 | loss: 0.3069180
	speed: 0.2320s/iter; left time: 4749.2898s
Epoch: 23 cost time: 65.02933764457703
Epoch: 23, Steps: 265 | Train Loss: 0.2743065 Vali Loss: 0.4911605 Test Loss: 0.3327902
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2962270
	speed: 0.9650s/iter; left time: 19595.2406s
	iters: 200, epoch: 24 | loss: 0.2823327
	speed: 0.2460s/iter; left time: 4970.6238s
Epoch: 24 cost time: 65.89856886863708
Epoch: 24, Steps: 265 | Train Loss: 0.2719738 Vali Loss: 0.4947424 Test Loss: 0.3364048
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2651491
	speed: 0.9752s/iter; left time: 19544.1451s
	iters: 200, epoch: 25 | loss: 0.2612214
	speed: 0.2338s/iter; left time: 4662.1148s
Epoch: 25 cost time: 64.54694700241089
Epoch: 25, Steps: 265 | Train Loss: 0.2698806 Vali Loss: 0.4938354 Test Loss: 0.3358965
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2562869
	speed: 1.0020s/iter; left time: 19815.4802s
	iters: 200, epoch: 26 | loss: 0.2855764
	speed: 0.4800s/iter; left time: 9444.6149s
Epoch: 26 cost time: 113.36828303337097
Epoch: 26, Steps: 265 | Train Loss: 0.2673095 Vali Loss: 0.4895642 Test Loss: 0.3357093
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2660639
	speed: 3.0000s/iter; left time: 58533.0114s
	iters: 200, epoch: 27 | loss: 0.2932485
	speed: 0.6340s/iter; left time: 12306.5144s
Epoch: 27 cost time: 162.29729628562927
Epoch: 27, Steps: 265 | Train Loss: 0.2649562 Vali Loss: 0.5019316 Test Loss: 0.3341512
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2486024
	speed: 3.8562s/iter; left time: 74215.9743s
	iters: 200, epoch: 28 | loss: 0.2437505
	speed: 0.5288s/iter; left time: 10124.8025s
Epoch: 28 cost time: 146.55948066711426
Epoch: 28, Steps: 265 | Train Loss: 0.2625318 Vali Loss: 0.5005400 Test Loss: 0.3351027
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.2673930
	speed: 2.3604s/iter; left time: 44802.5967s
	iters: 200, epoch: 29 | loss: 0.2493115
	speed: 0.3647s/iter; left time: 6885.7178s
Epoch: 29 cost time: 99.78394865989685
Epoch: 29, Steps: 265 | Train Loss: 0.2599432 Vali Loss: 0.5022844 Test Loss: 0.3336174
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.2159885
	speed: 2.3581s/iter; left time: 44133.8614s
	iters: 200, epoch: 30 | loss: 0.2564474
	speed: 0.3668s/iter; left time: 6828.9096s
Epoch: 30 cost time: 100.87598061561584
Epoch: 30, Steps: 265 | Train Loss: 0.2574623 Vali Loss: 0.5091377 Test Loss: 0.3391864
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.2403135
	speed: 2.0883s/iter; left time: 38531.8485s
	iters: 200, epoch: 31 | loss: 0.2907114
	speed: 0.3440s/iter; left time: 6312.2912s
Epoch: 31 cost time: 97.54281783103943
Epoch: 31, Steps: 265 | Train Loss: 0.2551203 Vali Loss: 0.5055395 Test Loss: 0.3361039
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.2420268
	speed: 2.2108s/iter; left time: 40204.7559s
	iters: 200, epoch: 32 | loss: 0.2591445
	speed: 0.3169s/iter; left time: 5732.2999s
Epoch: 32 cost time: 89.95035314559937
Epoch: 32, Steps: 265 | Train Loss: 0.2523420 Vali Loss: 0.5184252 Test Loss: 0.3410413
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.2243737
	speed: 2.2770s/iter; left time: 40806.0853s
	iters: 200, epoch: 33 | loss: 0.2517552
	speed: 0.3397s/iter; left time: 6053.9698s
Epoch: 33 cost time: 92.17831230163574
Epoch: 33, Steps: 265 | Train Loss: 0.2496509 Vali Loss: 0.5212501 Test Loss: 0.3423233
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.2420342
	speed: 2.1483s/iter; left time: 37930.5372s
	iters: 200, epoch: 34 | loss: 0.2270991
	speed: 0.7590s/iter; left time: 13324.9508s
Epoch: 34 cost time: 160.47605848312378
Epoch: 34, Steps: 265 | Train Loss: 0.2471823 Vali Loss: 0.5225560 Test Loss: 0.3406738
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.477380205092656e-05
	iters: 100, epoch: 35 | loss: 0.2449255
	speed: 4.2000s/iter; left time: 73041.8388s
	iters: 200, epoch: 35 | loss: 0.2287094
	speed: 0.7562s/iter; left time: 13074.5958s
Epoch: 35 cost time: 197.99340891838074
Epoch: 35, Steps: 265 | Train Loss: 0.2440898 Vali Loss: 0.5119197 Test Loss: 0.3412560
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.635098009292423e-05
	iters: 100, epoch: 36 | loss: 0.2220795
	speed: 4.0820s/iter; left time: 69908.4020s
	iters: 200, epoch: 36 | loss: 0.2255988
	speed: 0.3492s/iter; left time: 5945.7992s
Epoch: 36 cost time: 116.92302203178406
Epoch: 36, Steps: 265 | Train Loss: 0.2410954 Vali Loss: 0.5198727 Test Loss: 0.3442269
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.765466802150444e-05
	iters: 100, epoch: 37 | loss: 0.2776124
	speed: 2.0776s/iter; left time: 35030.9074s
	iters: 200, epoch: 37 | loss: 0.2415447
	speed: 0.3372s/iter; left time: 5652.3591s
Epoch: 37 cost time: 93.97737979888916
Epoch: 37, Steps: 265 | Train Loss: 0.2382980 Vali Loss: 0.5264826 Test Loss: 0.3510720
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.867682665109111e-05
	iters: 100, epoch: 38 | loss: 0.2301858
	speed: 2.1689s/iter; left time: 35995.4805s
	iters: 200, epoch: 38 | loss: 0.2316093
	speed: 0.3533s/iter; left time: 5827.8324s
Epoch: 38 cost time: 94.87728905677795
Epoch: 38, Steps: 265 | Train Loss: 0.2356191 Vali Loss: 0.5340639 Test Loss: 0.3446093
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.941115284522702e-05
	iters: 100, epoch: 39 | loss: 0.2429122
	speed: 2.1790s/iter; left time: 35585.1930s
	iters: 200, epoch: 39 | loss: 0.2128889
	speed: 0.3528s/iter; left time: 5726.5249s
Epoch: 39 cost time: 96.03076720237732
Epoch: 39, Steps: 265 | Train Loss: 0.2328894 Vali Loss: 0.5349674 Test Loss: 0.3498385
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.985311838483566e-05
	iters: 100, epoch: 40 | loss: 0.2109454
	speed: 2.1777s/iter; left time: 34987.6856s
	iters: 200, epoch: 40 | loss: 0.2373860
	speed: 0.3234s/iter; left time: 5163.4623s
Epoch: 40 cost time: 90.44931983947754
Epoch: 40, Steps: 265 | Train Loss: 0.2301840 Vali Loss: 0.5391695 Test Loss: 0.3487386
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.99999990240136e-05
	iters: 100, epoch: 41 | loss: 0.2261376
	speed: 2.1916s/iter; left time: 34629.3169s
	iters: 200, epoch: 41 | loss: 0.2316610
	speed: 0.3254s/iter; left time: 5109.8450s
Epoch: 41 cost time: 92.38419151306152
Epoch: 41, Steps: 265 | Train Loss: 0.2275867 Vali Loss: 0.5440589 Test Loss: 0.3570293
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3318631649017334, mae:0.3693121671676636, rse:0.5479286313056946
